// Generated from: docs/features/tipping/tip_to_skip.feature
import { test } from "playwright-bdd";

test.describe('Tip to Skip the Queue', () => {

  test.beforeEach('Background', async ({ Given, page, And }) => {
    await Given('the KJ is running an online session', null, { page }); 
    await And('the "Tip to Skip" feature is enabled'); 
    await And('the KJ has configured the following tiers:', {"dataTable":{"rows":[{"cells":[{"value":"tip_amount"},{"value":"spots_to_skip"}]},{"cells":[{"value":"5.00"},{"value":"3"}]},{"cells":[{"value":"10.00"},{"value":"5"}]}]}}); 
    await And('the cooldown period between skips is 2 songs'); 
    await And('the per-singer skip limit is 1 per night'); 
  });
  
  test('Singer tips to move up in the queue', { tag: ['@tipping', '@monetization'] }, async ({ Given, And, When, Then }) => { 
    await Given('there are 10 singers in the queue'); 
    await And('a singer named " impatient" is at position 8'); 
    await When('"impatient" chooses to tip $5.00 to skip'); 
    await Then('their position in the queue should change from 8 to 5'); 
    await And('the KJ Admin Interface should reflect the new queue order'); 
  });

  test('A singer attempts to skip beyond their limit', { tag: ['@tipping', '@monetization'] }, async ({ Given, When, Then, And }) => { 
    await Given('a singer named "impatient" has already used their one skip for the night'); 
    await When('"impatient" attempts to tip to skip again'); 
    await Then('the UI should show a message "You have reached your skip limit for the night."'); 
    await And('the tip should not be processed'); 
  });

  test('A singer attempts to skip during the cooldown period', { tag: ['@tipping', '@monetization'] }, async ({ Given, And, When, Then }) => { 
    await Given('a singer just tipped to skip in the previous turn'); 
    await And('a singer named "eager" is at position 6'); 
    await When('"eager" attempts to tip to skip'); 
    await Then('the UI should show a message "The queue is currently on a cooldown. Please try again after the next singer."'); 
    await And('the tip should not be processed'); 
  });

});

// == technical section ==

test.use({
  $test: ({}, use) => use(test),
  $uri: ({}, use) => use('docs/features/tipping/tip_to_skip.feature'),
  $bddFileData: ({}, use) => use(bddFileData),
});

const bddFileData = [ // bdd-data-start
  {"pwTestLine":14,"pickleLine":16,"tags":["@tipping","@monetization"],"steps":[{"pwStepLine":7,"gherkinStepLine":7,"keywordType":"Context","textWithKeyword":"Given the KJ is running an online session","isBg":true,"stepMatchArguments":[]},{"pwStepLine":8,"gherkinStepLine":8,"keywordType":"Context","textWithKeyword":"And the \"Tip to Skip\" feature is enabled","isBg":true,"stepMatchArguments":[{"group":{"start":4,"value":"\"Tip to Skip\"","children":[{"start":5,"value":"Tip to Skip","children":[{"children":[]}]},{"children":[{"children":[]}]}]},"parameterTypeName":"string"}]},{"pwStepLine":9,"gherkinStepLine":9,"keywordType":"Context","textWithKeyword":"And the KJ has configured the following tiers:","isBg":true,"stepMatchArguments":[]},{"pwStepLine":10,"gherkinStepLine":13,"keywordType":"Context","textWithKeyword":"And the cooldown period between skips is 2 songs","isBg":true,"stepMatchArguments":[{"group":{"start":37,"value":"2","children":[]},"parameterTypeName":"int"}]},{"pwStepLine":11,"gherkinStepLine":14,"keywordType":"Context","textWithKeyword":"And the per-singer skip limit is 1 per night","isBg":true,"stepMatchArguments":[{"group":{"start":29,"value":"1","children":[]},"parameterTypeName":"int"}]},{"pwStepLine":15,"gherkinStepLine":17,"keywordType":"Context","textWithKeyword":"Given there are 10 singers in the queue","stepMatchArguments":[{"group":{"start":10,"value":"10","children":[]},"parameterTypeName":"int"}]},{"pwStepLine":16,"gherkinStepLine":18,"keywordType":"Context","textWithKeyword":"And a singer named \" impatient\" is at position 8","stepMatchArguments":[{"group":{"start":15,"value":"\" impatient\"","children":[{"start":16,"value":" impatient","children":[{"children":[]}]},{"children":[{"children":[]}]}]},"parameterTypeName":"string"},{"group":{"start":43,"value":"8","children":[]},"parameterTypeName":"int"}]},{"pwStepLine":17,"gherkinStepLine":19,"keywordType":"Action","textWithKeyword":"When \"impatient\" chooses to tip $5.00 to skip","stepMatchArguments":[{"group":{"start":0,"value":"\"impatient\"","children":[{"start":1,"value":"impatient","children":[{"children":[]}]},{"children":[{"children":[]}]}]},"parameterTypeName":"string"},{"group":{"start":28,"value":"5.00","children":[]},"parameterTypeName":"float"}]},{"pwStepLine":18,"gherkinStepLine":20,"keywordType":"Outcome","textWithKeyword":"Then their position in the queue should change from 8 to 5","stepMatchArguments":[{"group":{"start":47,"value":"8","children":[]},"parameterTypeName":"int"},{"group":{"start":52,"value":"5","children":[]},"parameterTypeName":"int"}]},{"pwStepLine":19,"gherkinStepLine":21,"keywordType":"Outcome","textWithKeyword":"And the KJ Admin Interface should reflect the new queue order","stepMatchArguments":[]}]},
  {"pwTestLine":22,"pickleLine":23,"tags":["@tipping","@monetization"],"steps":[{"pwStepLine":7,"gherkinStepLine":7,"keywordType":"Context","textWithKeyword":"Given the KJ is running an online session","isBg":true,"stepMatchArguments":[]},{"pwStepLine":8,"gherkinStepLine":8,"keywordType":"Context","textWithKeyword":"And the \"Tip to Skip\" feature is enabled","isBg":true,"stepMatchArguments":[{"group":{"start":4,"value":"\"Tip to Skip\"","children":[{"start":5,"value":"Tip to Skip","children":[{"children":[]}]},{"children":[{"children":[]}]}]},"parameterTypeName":"string"}]},{"pwStepLine":9,"gherkinStepLine":9,"keywordType":"Context","textWithKeyword":"And the KJ has configured the following tiers:","isBg":true,"stepMatchArguments":[]},{"pwStepLine":10,"gherkinStepLine":13,"keywordType":"Context","textWithKeyword":"And the cooldown period between skips is 2 songs","isBg":true,"stepMatchArguments":[{"group":{"start":37,"value":"2","children":[]},"parameterTypeName":"int"}]},{"pwStepLine":11,"gherkinStepLine":14,"keywordType":"Context","textWithKeyword":"And the per-singer skip limit is 1 per night","isBg":true,"stepMatchArguments":[{"group":{"start":29,"value":"1","children":[]},"parameterTypeName":"int"}]},{"pwStepLine":23,"gherkinStepLine":24,"keywordType":"Context","textWithKeyword":"Given a singer named \"impatient\" has already used their one skip for the night","stepMatchArguments":[{"group":{"start":15,"value":"\"impatient\"","children":[{"start":16,"value":"impatient","children":[{"children":[]}]},{"children":[{"children":[]}]}]},"parameterTypeName":"string"}]},{"pwStepLine":24,"gherkinStepLine":25,"keywordType":"Action","textWithKeyword":"When \"impatient\" attempts to tip to skip again","stepMatchArguments":[{"group":{"start":0,"value":"\"impatient\"","children":[{"start":1,"value":"impatient","children":[{"children":[]}]},{"children":[{"children":[]}]}]},"parameterTypeName":"string"}]},{"pwStepLine":25,"gherkinStepLine":26,"keywordType":"Outcome","textWithKeyword":"Then the UI should show a message \"You have reached your skip limit for the night.\"","stepMatchArguments":[{"group":{"start":29,"value":"\"You have reached your skip limit for the night.\"","children":[{"start":30,"value":"You have reached your skip limit for the night.","children":[{"children":[]}]},{"children":[{"children":[]}]}]},"parameterTypeName":"string"}]},{"pwStepLine":26,"gherkinStepLine":27,"keywordType":"Outcome","textWithKeyword":"And the tip should not be processed","stepMatchArguments":[]}]},
  {"pwTestLine":29,"pickleLine":29,"tags":["@tipping","@monetization"],"steps":[{"pwStepLine":7,"gherkinStepLine":7,"keywordType":"Context","textWithKeyword":"Given the KJ is running an online session","isBg":true,"stepMatchArguments":[]},{"pwStepLine":8,"gherkinStepLine":8,"keywordType":"Context","textWithKeyword":"And the \"Tip to Skip\" feature is enabled","isBg":true,"stepMatchArguments":[{"group":{"start":4,"value":"\"Tip to Skip\"","children":[{"start":5,"value":"Tip to Skip","children":[{"children":[]}]},{"children":[{"children":[]}]}]},"parameterTypeName":"string"}]},{"pwStepLine":9,"gherkinStepLine":9,"keywordType":"Context","textWithKeyword":"And the KJ has configured the following tiers:","isBg":true,"stepMatchArguments":[]},{"pwStepLine":10,"gherkinStepLine":13,"keywordType":"Context","textWithKeyword":"And the cooldown period between skips is 2 songs","isBg":true,"stepMatchArguments":[{"group":{"start":37,"value":"2","children":[]},"parameterTypeName":"int"}]},{"pwStepLine":11,"gherkinStepLine":14,"keywordType":"Context","textWithKeyword":"And the per-singer skip limit is 1 per night","isBg":true,"stepMatchArguments":[{"group":{"start":29,"value":"1","children":[]},"parameterTypeName":"int"}]},{"pwStepLine":30,"gherkinStepLine":30,"keywordType":"Context","textWithKeyword":"Given a singer just tipped to skip in the previous turn","stepMatchArguments":[]},{"pwStepLine":31,"gherkinStepLine":31,"keywordType":"Context","textWithKeyword":"And a singer named \"eager\" is at position 6","stepMatchArguments":[{"group":{"start":15,"value":"\"eager\"","children":[{"start":16,"value":"eager","children":[{"children":[]}]},{"children":[{"children":[]}]}]},"parameterTypeName":"string"},{"group":{"start":38,"value":"6","children":[]},"parameterTypeName":"int"}]},{"pwStepLine":32,"gherkinStepLine":32,"keywordType":"Action","textWithKeyword":"When \"eager\" attempts to tip to skip","stepMatchArguments":[{"group":{"start":0,"value":"\"eager\"","children":[{"start":1,"value":"eager","children":[{"children":[]}]},{"children":[{"children":[]}]}]},"parameterTypeName":"string"}]},{"pwStepLine":33,"gherkinStepLine":33,"keywordType":"Outcome","textWithKeyword":"Then the UI should show a message \"The queue is currently on a cooldown. Please try again after the next singer.\"","stepMatchArguments":[{"group":{"start":29,"value":"\"The queue is currently on a cooldown. Please try again after the next singer.\"","children":[{"start":30,"value":"The queue is currently on a cooldown. Please try again after the next singer.","children":[{"children":[]}]},{"children":[{"children":[]}]}]},"parameterTypeName":"string"}]},{"pwStepLine":34,"gherkinStepLine":34,"keywordType":"Outcome","textWithKeyword":"And the tip should not be processed","stepMatchArguments":[]}]},
]; // bdd-data-end